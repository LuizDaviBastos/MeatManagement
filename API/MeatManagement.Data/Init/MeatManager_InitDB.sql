CREATE TABLE [dbo].[State] (
    [Id] UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    [Name] NVARCHAR(100) NOT NULL,
    [UF] NVARCHAR(2) NOT NULL
);

CREATE TABLE [dbo].[City] (
    [Id] UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    [Name] NVARCHAR(100) NOT NULL,
    [StateId] UNIQUEIDENTIFIER NOT NULL FOREIGN KEY REFERENCES [dbo].[State]([Id])
);

CREATE TABLE [dbo].[Buyers] (
    Id UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    Name NVARCHAR(150) NOT NULL,
    Document NVARCHAR(20) NOT NULL,
    DocumentType NVARCHAR(MAX) NOT NULL,
    CreatedAt DATETIME2 NOT NULL
);

CREATE TABLE [dbo].[Address] (
    Id UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    BuyerId UNIQUEIDENTIFIER NOT NULL,
    StateId UNIQUEIDENTIFIER NULL,
    CityId UNIQUEIDENTIFIER NULL,
    CONSTRAINT FK_Address_Buyers FOREIGN KEY (BuyerId) REFERENCES Buyers(Id) ON DELETE CASCADE,
    CONSTRAINT FK_Address_City FOREIGN KEY (CityId) REFERENCES City(Id),
    CONSTRAINT FK_Address_State FOREIGN KEY (StateId) REFERENCES State(Id)
);

CREATE TABLE [dbo].[Meats] (
    Id UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    Name NVARCHAR(100) NOT NULL,
    Origin NVARCHAR(MAX) NOT NULL,
    CreatedAt DATETIME2 NOT NULL
);

CREATE TABLE [dbo].[Orders] (
    Id UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    OrderDate DATETIME2 NOT NULL,
    BuyerId UNIQUEIDENTIFIER NOT NULL,
    CONSTRAINT FK_Orders_Buyers FOREIGN KEY (BuyerId) REFERENCES Buyers(Id)
);

CREATE TABLE [dbo].[OrderItem] (
    Id UNIQUEIDENTIFIER NOT NULL PRIMARY KEY,
    Price DECIMAL(18,2) NOT NULL,
    CurrencyCode NVARCHAR(MAX) NOT NULL,
    OrderId UNIQUEIDENTIFIER NOT NULL,
    MeatId UNIQUEIDENTIFIER NOT NULL,
    CONSTRAINT FK_OrderItem_Orders FOREIGN KEY (OrderId) REFERENCES Orders(Id) ON DELETE CASCADE,
    CONSTRAINT FK_OrderItem_Meats FOREIGN KEY (MeatId) REFERENCES Meats(Id)
);

--Seeds
INSERT INTO [State] (Id, Name, UF)
VALUES 
  ('1E3F5A1B-2D4C-4F8A-9E2A-1234567890AB', 'São Paulo', 'SP'),
  ('2B4C6D7E-3F8A-4B2C-9F3D-2345678901BC', 'Rio de Janeiro', 'RJ'),
  ('3C5D7E8F-4A1B-5C3D-0A4E-3456789012CD', 'Minas Gerais', 'MG'),
  ('4D6E7F8A-1B2C-3D4E-5F6A-4567890123EE', 'Paraná', 'PR'),
  ('5E7F8A9B-2C3D-4E5F-6A7B-5678901234FF', 'Rio Grande do Sul', 'RS'),
  ('6F8A9B0C-3D4E-5F6A-7B8C-6789012345AA', 'Bahia', 'BA'),
  ('7A9B0C1D-4E5F-6A7B-8C9D-7890123456BB', 'Distrito Federal', 'DF');

INSERT INTO [City] (Id, Name, StateId)
VALUES 
  (NEWID(), 'São Paulo', '1E3F5A1B-2D4C-4F8A-9E2A-1234567890AB'),
  (NEWID(), 'Campinas', '1E3F5A1B-2D4C-4F8A-9E2A-1234567890AB'),
  (NEWID(), 'Santos', '1E3F5A1B-2D4C-4F8A-9E2A-1234567890AB'),
  (NEWID(), 'Rio de Janeiro', '2B4C6D7E-3F8A-4B2C-9F3D-2345678901BC'),
  (NEWID(), 'Niterói', '2B4C6D7E-3F8A-4B2C-9F3D-2345678901BC'),
  (NEWID(), 'Petrópolis', '2B4C6D7E-3F8A-4B2C-9F3D-2345678901BC'),
  (NEWID(), 'Belo Horizonte', '3C5D7E8F-4A1B-5C3D-0A4E-3456789012CD'),
  (NEWID(), 'Uberlândia', '3C5D7E8F-4A1B-5C3D-0A4E-3456789012CD'),
  (NEWID(), 'Ouro Preto', '3C5D7E8F-4A1B-5C3D-0A4E-3456789012CD'),
  (NEWID(), 'Curitiba', '4D6E7F8A-1B2C-3D4E-5F6A-4567890123EE'),
  (NEWID(), 'Londrina', '4D6E7F8A-1B2C-3D4E-5F6A-4567890123EE'),
  (NEWID(), 'Porto Alegre', '5E7F8A9B-2C3D-4E5F-6A7B-5678901234FF'),
  (NEWID(), 'Caxias do Sul', '5E7F8A9B-2C3D-4E5F-6A7B-5678901234FF'),
  (NEWID(), 'Salvador', '6F8A9B0C-3D4E-5F6A-7B8C-6789012345AA'),
  (NEWID(), 'Feira de Santana', '6F8A9B0C-3D4E-5F6A-7B8C-6789012345AA'),
  (NEWID(), 'Brasília', '7A9B0C1D-4E5F-6A7B-8C9D-7890123456BB');
